{% extends "base.html" %}
{% block content %}
  <section>
    <h2>Your forest plan <span class="chip chip--soft">Step 2 of 2</span></h2>

    <!-- Show basic context: region + soil -->
    <p class="section-subtitle">
      Region: <strong>{{ region }}</strong> • Soil: <strong>{{ soil }}</strong>
    </p>

    {% if recommendations.plants %}
      <!-- Two-column layout: tree list + impact metrics -->
      <div class="results-grid">
        <!-- List of recommended species + image pill + infographics + back button -->
        <div>
          <h3>Tree species to plant</h3>

          <!-- Image attached pill (shown only when image was uploaded) -->
          {% if has_image %}
          <div class="image-upload-banner image-upload-banner--visible">
            <span class="image-pill-dot"></span>
            <span class="image-pill-text">
              Image from your plot is attached for review.
            </span>
          </div>
          {% endif %}

          <ul class="plant-list">
            {% for p in recommendations.plants %}
              <li>{{ p }}</li>
            {% endfor %}
          </ul>

          <!-- Simple infographic-style bars under the list -->
          <div class="impact-bars">
            <div class="impact-bar">
              <span class="impact-label">Tree density advantage</span>
              <div class="impact-track">
                <div
                  class="impact-fill"
                  style="--fill-ratio: {{ comparison.trees_ratio / 3 }}">
                </div>
              </div>
              <span class="impact-value">{{ comparison.trees_ratio }}× more trees</span>
            </div>

            <div class="impact-bar">
              <span class="impact-label">Time to stability</span>
              <div class="impact-track">
                <div
                  class="impact-fill impact-fill--fast"
                  style="--fill-ratio: {{ 1 / comparison.speed_ratio }}">
                </div>
              </div>
              <span class="impact-value">{{ comparison.speed_ratio }}× faster</span>
            </div>
          </div>

          <!-- Back button directly below bars -->
          <div class="form-actions" style="margin-top: 10px;">
            <a href="{{ url_for('assess') }}" class="secondary-btn">Back to assessment</a>
          </div>
        </div>

        <!-- Calculated stats based on area and tree count -->
        <div class="metrics">
          <h3>Quick stats <span class="chip chip--soft">Demo estimates</span></h3>

          <!-- Basic plot info -->
          <p>
            Plot area:
            <strong>{{ area_sqm }} m²</strong>
          </p>

          <!-- Two sub-cards: Miyavaki vs Traditional -->
          <div class="metrics-cards">
            <!-- Miyavaki card -->
            <div class="stats-card">
              <h4>MIYAVAKI FOREST</h4>
              <p>
                Trees:
                <strong>{{ tree_count }}</strong>
              </p>
              <p>
                Cost per tree:
                <strong>₹{{ recommendations.cost_per_tree }}</strong>
              </p>
              <p>
                Total planting cost:
                <strong>₹{{ impact.total_cost }}</strong>
              </p>
              <p>
                Becomes self-sustaining in about
                <strong>{{ recommendations.maturity_months }} months</strong>
              </p>
              <p>
                CO₂ absorbed per year:
                <strong>{{ impact.co2_kg_per_year }} kg</strong>
              </p>
              <p>
                Oxygen released per year:
                <strong>{{ impact.oxygen_kg_per_year }} kg</strong>
              </p>
            </div>

            <!-- Traditional card -->
            <div class="stats-card stats-card--alt">
              <h4>TRADITIONAL PLANTATION</h4>
              <p>
                Trees:
                <strong>{{ traditional_tree_count }}</strong>
              </p>
              <p>
                Cost per tree:
                <strong>₹{{ traditional_cost_per_tree }}</strong>
              </p>
              <p>
                Total planting cost:
                <strong>₹{{ traditional_impact.total_cost }}</strong>
              </p>
              <p>
                Becomes stable in about
                <strong>{{ traditional_maturity_months }} months</strong>
              </p>
              <p>
                CO₂ absorbed per year:
                <strong>{{ traditional_impact.co2_kg_per_year }} kg</strong>
              </p>
              <p>
                Oxygen released per year:
                <strong>{{ traditional_impact.oxygen_kg_per_year }} kg</strong>
              </p>
            </div>
          </div>

          <!-- Short comparison note -->
          <p class="note">
            Miyavaki-style planting gives about
            <strong>{{ comparison.trees_ratio }}× more trees</strong>,
            reaches stability about
            <strong>{{ comparison.speed_ratio }}× faster</strong>,
            for roughly
            <strong>{{ comparison.cost_ratio }}× the cost</strong>
            on the same land (rough demo estimates).
          </p>
        </div>
      </div>

    {% else %}
      <!-- Fallback if no plant data for this combination -->
      <p class="section-subtitle">
        We don’t have data for this combination yet. Try a different region or soil type.
      </p>
    {% endif %}
<<<<<<< HEAD
=======
        <!-- How to plant this forest: simple, guided steps -->
    <div class="card forest-steps-card">
      <h3>How to plant this forest</h3>
      <p class="section-subtitle">
        Use this as a simple checklist for your {{ area_sqm }} m² plot.
      </p>

      <ol class="steps-list">
        <li>
          <strong>Prepare the soil:</strong>
          Clear weeds and debris, then loosen at least 30 cm of top soil.
          Mix in good compost or organic matter across the whole {{ area_sqm }} m² area so the soil stays moist and airy.
        </li>

        <li>
          <strong>Plan dense spacing:</strong>
          Aim for roughly 3–4 saplings per square meter so the canopy closes quickly.
          For your plot, plan to plant about <strong>{{ tree_count }}</strong> saplings, mixing different species together instead of in straight rows.
        </li>

        <li>
          <strong>Mix species well:</strong>
          Take the oxygen, fruit, and native species from your plan above and group them in small mixed clusters.
          Avoid planting the same species in long single-species lines; variety is the strength of a Miyawaki forest.
        </li>

        <li>
          <strong>Plant correctly:</strong>
          Dig pits slightly wider than the sapling roots, add a bit of compost at the bottom, place the sapling straight,
          and press soil firmly so there are no big air gaps around the roots.
        </li>

        <li>
          <strong>Mulch and protect:</strong>
          After planting, cover the surface with dry leaves, straw, or other organic mulch to keep moisture and suppress weeds.
          Add a simple fence or markers so people do not walk through the young forest by mistake.
        </li>

        <li>
          <strong>Care for the first years:</strong>
          Water regularly (especially in the first hot season) and remove aggressive weeds near the saplings.
          With good care for roughly {{ recommendations.maturity_months or 24 }} months, the forest should become mostly self-sustaining.
        </li>
      </ol>
    </div>

    <!-- Actions: back + add progress photo -->
    <div class="form-actions">
      <a href="{{ url_for('assess') }}" class="secondary-btn">
        Back to assessment
      </a>

      <a
        href="{{ url_for('progress', region=region, soil=soil, area_sqm=area_sqm) }}"
        class="primary-btn"
      >
        Add progress photo
      </a>
      <a href="{{ url_for('gallery') }}" class="secondary-btn">
    View gallery
      </a>
    </div>
>>>>>>> 0c6b4d6e2010b3f55d8d0ad25f62e3b97830aade
  </section>
{% endblock %}
